"use strict";var catalog=function(e){function t(){var e={};return location.search.substr(1).split("&").forEach(function(t){var a=t.split("=");e[a[0]]=decodeURIComponent(a[1])}),e}function a(e,a){var o=t();return o[e]=a,o}function o(e){var t=[];return Object.keys(e).map(function(a){"undefined"!==e[a]&&""!==e[a]&&t.push([a,e[a]].join("="))}),t.join("&")}function n(e){if(Object.keys(e).length){var t="";Object.keys(e).map(function(a){"page"!==a&&"undefined"!==e[a]&&""!==e[a]&&(""!==t&&(t+="&"),t+=[a,e[a]].join("="))}),location.search=t}}return{tab:function(t,a){e(".tabs__list__link").removeClass("tabs__list__link_current"),e(".catalog-tabs__item").removeClass("current"),e(t).addClass("tabs__list__link_current"),e("#tab-"+a).addClass("current")},sort:function(e){var n=t();if(void 0!==n.sort){var c=n.sort.split("-")[1];c="asc"===c?"desc":"asc",location.search=o(a("sort",e+"-"+c))}else location.search=o(a("sort",e+"-asc"))},search:function(e,t,o,c){o?13==c.keyCode&&n(a(e,t)):n(a(e,t))},reload:function(){var e=t();if(void 0!==e.page){var a=e.page-1>=0?e.page-1:"";a?location.search="page="+a:location.reload()}else location.reload()},setLimit:function(t,a){var o=parseInt(a.value);if(o>0){var n=["module","pages",t].join("_");e.removeCookie(n),e.cookie(n,o,{expires:30,path:"/"}),setTimeout(function(){location.reload()},50)}},update:function(t,a,o){var n=Number(t.target.checked);e.ajax({url:["/",ADMIN_DIR,"/shopping/update"].join(""),type:"post",data:{id:o,name:a,value:n},dataType:"JSON",success:function(e){console.log("update")}})},checkAll:function(t){var a=e(t).prop("checked");e(".check-all-spy").prop("checked",a),a?e("#remove-button").addClass("enable"):e("#remove-button").removeClass("enable")},checkItem:function(t){e(".check-all-spy:checked").length?e("#remove-button").addClass("enable"):e("#remove-button").removeClass("enable")},deleteProduct:function(e,t){e.preventDefault(),cp.dialog("Вы действительно хотите удалить товар?")&&this.deleteItem(t,!0)},deleteItem:function(t,a){e.ajax({url:["/",ADMIN_DIR,"/shopping/delete"].join(""),type:"post",data:{id:t},dataType:"JSON",success:function(){e("#module-table").find('.module-table__row[data-id="'+t+'"]').remove(),a&&cp.notify("Товар удален","info")}})},deleteAll:function(t){t.preventDefault();var a=e(".check-all-spy:checked").length,o=e(".check-all-spy").length;if(a){var n=this;cp.dialog(["Вы действительно хотите удалить ",declOfNum(a,["товар","товара","товаров"]),"?"].join(""))&&e(".check-all-spy:checked").each(function(t,c){n.deleteItem(parseInt(e(c).val()),!1),t+1==a&&(cp.notify(["Удалено ",declOfNum(a,["товар","товара","товаров"])].join(""),"info"),setTimeout(function(){a==o?n.reload():location.reload()},150))})}}}}(jQuery),order=(jQuery,{});