"use strict";function declOfNum(e,t){var i=[2,0,1,1,1,2];return e=Math.abs(e),[e,t[e%100>4&&e%100<20?2:i[e%10<5?e%10:5]]].join(" ")}function saving(e,t){$.ajax({url:"/"+ADMIN_DIR+"/save/",type:"post",data:{id:e,cont:t,pathname:location.pathname},dataType:"JSON",success:function(e){1==e?alert("Данные удачно сохранены."):alert("Ошибка, данные небыли сохранены.")}})}function isFullScreen(e){return/\bCodeMirror-fullscreen\b/.test(e.getWrapperElement().className)}function winHeight(){return window.innerHeight||(document.documentElement||document.body).clientHeight}function setFullScreen(e,t){var i=e.getWrapperElement(),n=e.getScrollerElement();t?(i.className+=" CodeMirror-fullscreen",n.style.height=winHeight()+"px",document.documentElement.style.overflow="hidden"):(i.className=i.className.replace(" CodeMirror-fullscreen",""),n.style.height="",document.documentElement.style.overflow=""),e.refresh()}function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function is_string(e){return"string"==typeof e}function is_numeric(e){return!isNaN(parseFloat(e))&&isFinite(e)}function checkAll(e){var t=$(e).prop("checked");$(".check-all-spy").prop("checked",t)}function yandexMaps(e){var t={link:null,mapid:"map-conteiner-"+e,place:"krasnodar",type:"yandex#map",city:{krasnodar:[45.09471716593029,39.01589900000001],moscow:[55.76,37.64]},getBaloon:function(e){return new ymaps.Placemark(e,{},{draggable:!0})},draw:function(e){t.link=new e.Map(this.mapid,{center:t.city[this.place],zoom:12,type:t.type}),t.link.controls.add("smallZoomControl",{right:10,top:15}).add(new e.control.ScaleLine).add("searchControl",{left:20,top:20});var i=this.getBaloon(t.city[this.place]);t.link.events.add("click",function(e){t.link.geoObjects.remove(i),i=t.getBaloon(e.get("coordPosition")),t.link.geoObjects.add(i),t.setCoord(e.get("coordPosition"))}),t.link.geoObjects.add(i).events.add("dragend",function(e){var i=e.get("target"),n=i.geometry.getCoordinates();i.properties.set("balloonContent",n),t.setCoord(n)})},add:function(){if(1==arguments.length)t.link.geoObjects.add(new ymaps.GeoObject({geometry:{type:"Point",coordinates:arguments[0]}}));else{for(var e=new ymaps.GeoObjectCollection,i=0;i<arguments.length;i++)e.add(new ymaps.Placemark(arguments[i]));t.link.geoObjects.add(e)}}};ymaps.ready(function(){t.draw(ymaps)})}function googleMaps(e){new google.maps.Map(d.getElementById("map-conteiner-"+e),{zoom:14,zoomControl:!1,panControl:!1,scrollwheel:!1,navigationControl:!1,mapTypeControl:!1,scaleControl:!1,draggable:!0,disableDoubleClickZoom:!0,center:new google.maps.LatLng(45.053548,39.016056)})}function selectize(e){var t=null;is_string(e=e||"select")?t=$(e):is_object(e)&&(t=e),t.chosen({width:"100%",allow_single_deselect:!0,no_results_text:"Не найдено!",disable_search_threshold:10})}function changeRow(e){$(e).prop("checked")?$(e).closest("tr").find("td").addClass("ch"):$(e).closest("tr").find("td").removeClass("ch")}function toggle_small_photo(e){$("#"+e).toggle()}function removeSection(e,t,i,n){if(t.preventDefault(),confirm("Вы действительно хотите удалить?")){i=parseInt(i);var o,a=[],s=$(e).val().split(",");for(o in s)""!==s[o]&&parseInt(s[o])!==i&&a.push(parseInt(s[o]));$(n).remove(),$(e).val(a.length>1?a.join(","):a)}return!1}function slider(e,t,i,n,o,a){var s="#"+e;a=a||"horizontal",n=n||0,o=o||100;var r=i,l="lower",d="tap-drag";"range"==t&&(d="tap-drag",l=!0,r=[i[0],i[1]]),$(s).noUiSlider({animate:!1,orientation:a,start:r,connect:l,behaviour:d,range:{min:n,max:o}}),"range"==t?($(s).Link("lower").to($(s+"-min"),null,wNumb({decimals:0})),$(s).Link("upper").to($(s+"-max"),null,wNumb({decimals:0}))):$(s).Link("lower").to($(s+"-value"),null,wNumb({decimals:0}))}function metaCounter(){$(".count-number").on("keyup",function(){var e=$(this).closest(".count-number-block").find(".count-number-block-count"),t=parseInt(e.data("recomend"))||"";e.html($(this).val().length+(""!==t?"/"+t:"")),""!==t&&$(this).val().length>t?e.addClass("unlim"):e.hasClass("unlim")&&e.removeClass("unlim")})}function seoCrowl(){$("input[name='changefreq']").on("change",function(){"fixed"==$.trim($(this).val())?$("#changefreq_fixed").removeClass("hidden"):$("#changefreq_fixed").addClass("hidden")}),$("input[name='priority']").on("change",function(){"fixed"==$.trim($(this).val())?$("#priority_fixed").removeClass("hidden"):$("#priority_fixed").addClass("hidden")})}function toggle_item(e,t,i,n){e.preventDefault(),$("#"+i).toggle();var o=$(t).find(".icon");o.hasClass(n[0])?(o.removeClass(n[0]),o.addClass(n[1])):(o.removeClass(n[1]),o.addClass(n[0]))}function switch_type_fields(e){!0===e.checked?($("#case2").hide(),$("#case2 input").attr({disabled:!0}),$("#case1").show(),$("#case1 input").attr({disabled:!1})):($("#case1").hide(),$("#case1 input").attr({disabled:!0}),$("#case2").show(),$("#case2 input").attr({disabled:!1}))}function show_tr(e){var t=$(e).val();10==t||11==t||12==t?$("#to_list").show():$("#to_list").hide()}function translate_key(e){$(e).val(PassGenJS.getPassword({symbols:0,letters:random(14,24),numbers:0,lettersUpper:0}))}function secret(e,t){$(e).val(PassGenJS.getPassword({symbols:0,letters:random(2,4),numbers:random(2,4),lettersUpper:random(3,7)}))}function random(e,t){return e=e||0,t=t||100,Math.floor(Math.random()*(t-e+1))+e}function token(e){e=e||8;var t="",n="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";for(i=1;i<e;i++){var o=Math.floor(Math.random()*n.length+1);t+=n.charAt(o)}return t}function del_list_fields(e){return cp.dialog("Вы дейсвительно хотите удалить поле?")&&$("#tr"+e).remove(),!1}function add_list_fields(){field_counter++,str='<tr id="tr'+field_counter+'">',str+='<td><input type="hidden" name="field_id['+field_counter+']" value="0" />',str+='<input type="text" name="field_name['+field_counter+']" class="bord padd ness" /></td>',str+='<td><input type="text" name="field_sys_name['+field_counter+']" class="bord padd ness" /></td>',str+='<td><select name="field_type['+field_counter+']" class="field_type ness" id="'+field_counter+'" onchange="select_type(this);">',$.each(arr_field_type,function(e,t){1*e&&(str+='<option value="'+e+'">'+t+"</option>")}),str+="</select></td>",str+='<td class="addition"></td>',str+='<td><input type="text" name="f_ord['+field_counter+']" value="'+field_counter+'0" class="bord padd w60px r" /></td>',str+='<td style="text-align:center"><input type="checkbox" name="in_list['+field_counter+']" /></td>',str+='<td class="actions c"><a href="#" class="ctr_a ctr_del margin" title="Удалить" onclick="del_list_fields('+field_counter+');return false;"></a></td>',str+="</tr>",$("#add_btn").before(str)}function add_list_fields_list(){field_counter++;var e=['<tr id="tr'+field_counter+'">',"<td>",'<input type="hidden" name="field_id['+field_counter+']" value="0">','<input name="var['+field_counter+']" placeholder="Например: Краснодарский край">',"</td>",'<td><input name="value['+field_counter+']" placeholder="Например: 23"></td>','<td><label class="controll"><input type="checkbox" class="controll__input" value="'+field_counter+'" name="default['+field_counter+']"><span class="controll__visible controll__visible_checkbox"></span></label></td>','<td><input name="ord['+field_counter+']" value="'+field_counter+'0" class="ord integer reducing-trigger"></td>','<td class="tac"><a href="#" class="icon icon-delete remove-trigger" title="Удалить" onclick="del_list_fields('+field_counter+');return false;"></a></td>',"</tr>"].join("");$("#add_btn").before(e)}function del_fields(e){field_counter--,$("#tr"+e).remove()}function add_fields(){field_counter++;var e="",t="";for(t in arr_field_type)"string"==typeof arr_field_type[t]&&(e+='<option value="'+t+'">'+arr_field_type[t]+"</option>");var i=['<tr id="tr'+field_counter+'">','<td class="va_t"><input name="f_name['+field_counter+']" class="ness"></td>','<td class="va_t"><input name="f_sys_name['+field_counter+']" class="ness"></td>','<td class="va_t"><select name="f_type['+field_counter+']" class="f_type ness" data-placeholder="Тип поля" id="fieldtype_'+field_counter+'" onchange="select_type(this)">',e,"</select></td>",'<td class="addition va_t">'+get_addition("input",field_counter)+"</td>",'<td class="va_t"><input name="f_ord['+field_counter+']" value="'+field_counter+'0"></td>','<td class="va_m tac"><label class="controll controll_single"><input type="checkbox" class="controll__input" value="1" name="f_in_list['+field_counter+']"><span class="controll__visible controll__visible_checkbox"></span></label></td>','<td class="va_m tac"><label class="controll controll_single"><input type="checkbox" class="controll__input" value="1" name="f_index['+field_counter+']"><span class="controll__visible controll__visible_checkbox"></span></label></td>','<td class="va_m tac"><label class="controll controll_single"><input type="checkbox" class="controll__input" value="1" name="f_unique['+field_counter+']"><span class="controll__visible controll__visible_checkbox"></span></label></td>','<td class="tac"><a href="#" class="icon icon-delete remove-trigger" title="Удалить" onclick="del_fields('+field_counter+');return false;"></a></td>',"</tr>"].join("");$("#add_btn").before(i),selectize("#fieldtype_"+field_counter)}function add_fields_list(){field_counter++,str=['<tr id="tr'+field_counter+'">','<td><input name="var['+field_counter+']"></td>','<td><input name="value['+field_counter+']"></td>','<td><input type="checkbox" name="default['+field_counter+']"></td>','<td><input name="ord['+field_counter+']" value="'+field_counter+'0"></td>','<td class="tac"><a href="#" class="icon icon-delete remove-trigger" title="Удалить" onclick="del_fields('+field_counter+');return false;"></a></td>',"</tr>"].join("\n"),$("#add_btn").before(str)}function select_type(e){var t=1*$(e).attr("id").split("_")[1],i=$("#tr"+t+" .addition"),n=get_addition(e.value.split(":")[0],t);$(i).empty().append(n||""),selectize()}function get_addition(e,t){var i=[],n=[];if(["input","cost","int","hidden","document","timestamp","email","list","autocomplete","select","float","system","multiselect","datetime"].indexOf(e)>=0&&(n=['<div class="group">','<label class="group__item"><input type="radio" class="group__item__rb" name="f_width['+t+']" value="25"><span class="group__item__style"></span><span class="group__item__text">25%</span></label>','<label class="group__item"><input type="radio" class="group__item__rb" name="f_width['+t+']" value="50"><span class="group__item__style"></span><span class="group__item__text">50%</span></label>','<label class="group__item"><input type="radio" class="group__item__rb" name="f_width['+t+']" value="75"><span class="group__item__style"></span><span class="group__item__text">75%</span></label>','<label class="group__item"><input type="radio" class="group__item__rb" name="f_width['+t+']" value="100" checked><span class="group__item__style"></span><span class="group__item__text">100%</span></label>',"</div>"],["list","autocomplete","select","radio","multiselect","checkbox","system"].indexOf(e)>=0&&n.push('<div class="cb mb10"></div>')),"hidden"==e&&n.push('<input value="" name="f_hidden_default['+t+']" placeholder="Значение по умолчанию">'),"system"==e&&n.push('<input value="" name="f_binding['+t+']" placeholder="Например поле (title)">'),"date"==e&&(i=['<div class="help-cover">','<input name="f_date_format['+t+']" value="DD.MM.YYYY" placeholder="Формат даты">','<div class="tooltip tooltip-down">',"D — день,<br>","M — месяц (без нуля впереди)<br>","DD, MM — день и месяц с нулём впереди для значений от 1 до 9<br>","YY — 2-символьное обозначение года<br>","YYYY — 4-символьное обозначение года (год пишется полностью)","</div>","</div>"],n.push(i.join("\n"))),["file","image"].indexOf(e)>=0&&(i=['<div class="option-group option-combo">','<label><input type="radio" name="f_file_count['+t+']" value="0"><span class="option">Один файл</span></label>','<label><input type="radio" name="f_file_count['+t+']" value="1" checked><span class="option">Много файлов</span></label>',"</div>"],"image"==e&&i.push('<div class="cb mb10"></div>'),n.push(i.join("\n"))),["gallery","image"].indexOf(e)>=0&&"undefined"!=typeof CONFIGURE&&void 0!==CONFIGURE.image){var o=[],a=[],s=[],r="";o=['<div class="js-size-list">','<table class="table-simple">','<col><col><col><col width="57"><col width="20">',"<thead>","<tr>",'<td class="h">Префикс</td>','<td class="h">Ширина</td>','<td class="h">Высота</td>','<td class="h">Метод</td>','<td class="h"></td>',"</tr>","</thead>","<tbody>"],a=template("tpl_image_row",{index:0,button:!0,iteration:t}),s=["</tbody>","</table>",'<a href="#" class="add-size js-add-size" data-iteration="{$smarty.foreach.i.iteration}"><i class="icon icon-plus-square"></i> Добавить размер</a>',"</div>"],n.push(o.join("\n")),n.push(a),n.push(s.join("\n"))}if(["embedded"].indexOf(e)>=0){if(!is_undefined(MODULE_LIST)){var l,d="";for(l in MODULE_LIST)d+='<option value="'+l+'">'+MODULE_LIST[l].name+"</option>"}i=['<div class="j-select-wrapper">','<div class="mb5">','<select name="f_module['+t+']" data-placeholder="Выбрать модуль" class="j-select-choosen">','<option value="0">---</option>',d,"</select>","</div>",'<div class="clearfix j-select-container">','<select name="f_fields['+t+'][]" multiple data-placeholder="Выбрать" disabled></select>',"</div>","</div>"],n.push(i.join("\n"))}if(["list","section","autocomplete","select","radio","checkbox","multiselect"].indexOf(e)>=0&&(i=['<div class="cb clearfix">','<label class="controll"><input type="checkbox" class="controll__input" value="1" onchange="switch_types(this)" name="f_use_table_list['+t+']"><span class="controll__visible controll__visible_checkbox"></span><span class="controll__text">привязать к `#__mdd_lists`</span></label>','<div class="case case0">','<input name="f_table_name['+t+']" value="" class="mb5" placeholder="Название таблицы (#_news)">','<input name="f_table_field['+t+']" value="" placeholder="Поле (title)">',"</div>",'<div class="case case1 hidden">','<input name="f_table_list['+t+']" disabled placeholder="BIND списка" value="">',"</div>","</div>"],n.push(i.join("\n"))),["range","slider"].indexOf(e)>=0&&(i=['<div class="-col">','<div class="-left">','<input name="f_range['+t+'][min]" value="" placeholder="Min" class="integer">',"</div>",'<div class="-right">','<input name="f_range['+t+'][max]" value="" placeholder="Max" class="integer">',"</div>","</div>"],n.push(i.join("\n"))),"editor"==e&&"undefined"!=typeof CONFIGURE&&void 0!==CONFIGURE.editor){(i=[]).push('<div class="option-group option-combo">');r="";for(c in CONFIGURE.editor)r="",void 0!==CONFIGURE.editor[c].default&&1==CONFIGURE.editor[c].default&&(r=" checked"),i.push('<label><input type="radio" name="f_editor['+t+']" value="'+CONFIGURE.editor[c].system+'" '+r+'><span class="option">'+CONFIGURE.editor[c].name+"</span></label>");if(i.push("</div>"),"undefined"!=typeof CONFIGURE&&void 0!==CONFIGURE.editor_mode){i.push('<div class="cb mb10"></div>'),i.push('<div class="option-group">');for(c in CONFIGURE.editor_mode)i.push('<label><input type="radio" name="f_editor_mode['+t+']" value="'+CONFIGURE.editor_mode[c]+'"><span class="option">'+CONFIGURE.editor_mode[c]+"</span></label>");i.push("</div>")}n.push(i.join("\n"))}if("redactor"==e&&"undefined"!=typeof CONFIGURE&&void 0!==CONFIGURE.redactor){(i=[]).push('<div class="group">');var c,r="";for(c in CONFIGURE.redactor)void 0!==CONFIGURE.redactor[c].name&&void 0!==CONFIGURE.redactor[c].system&&(r="",void 0!==CONFIGURE.redactor[c].default&&1==CONFIGURE.redactor[c].default&&(r=" checked"),i.push('<label class="group__item"><input type="radio" class="group__item__rb" name="f_redactor['+t+']" value="'+CONFIGURE.redactor[c].system+'"'+r+'><span class="group__item__style"></span><span class="group__item__text">'+CONFIGURE.redactor[c].name+"</span></label>"));i.push("</div>"),n.push(i.join("\n"))}return n.join("\n")}function switch_types(e){p_obj=$(e).closest("td"),e.checked?($(".case1",p_obj).show(),$(".case1 input",p_obj).attr({disabled:!1}),$(".case0",p_obj).hide(),$(".case0 input",p_obj).attr({disabled:!0})):($(".case0",p_obj).show(),$(".case0 input",p_obj).attr({disabled:!1}),$(".case1",p_obj).hide(),$(".case1 input",p_obj).attr({disabled:!0}))}function humanSize(e){return"number"!=typeof e?"":e>=1e9?(e/1e9).toFixed(2)+" Гб":e>=1e6?(e/1e6).toFixed(2)+" Мб":e>=1024?(e/1e3).toFixed(2)+" Кб":e+" б"}function addExtendet(){function e(e){var t;t=1==$("#VoteAddQuestions input:radio[name=visible]:checked").val()?"Да":"Нет";var i='<tr id="tr_'+e+'">';i+="<td>",i+='<input name="parent_id_'+e+'" id="parent_id_'+e+'" value="2" type="hidden">',i+='<input name="id_'+e+'" id="id_'+e+'" value="'+e+'" type="hidden">',i+='<div id="title_'+e+'"><b>'+$("#title").attr("value")+"</b></div>",i+='<div id="title_i_'+e+'" style="display: none;">',i+='<input name="title_'+e+'" value="'+$("#title").attr("value")+'" class="bord padd w100" id="title_input_'+e+'" type="text">',i+='<p align="right">',i+='<a href="javascript:;" onclick="saveExtendet(\''+e+"');\">Сохранить</a> | ",i+='<a href="javascript:;" onclick="cancelExtendet(\''+e+"');\">Отмена</a> ",i+="</p>",i+="</div>",i+="</td>",i+="<td>",i+='<div id="ord_'+e+'"><b>'+$("#ord").attr("value")+"</b></div>",i+='<div id="ord_i_'+e+'" style="display: none;">',i+='<input name="ord_'+e+'" value="'+$("#ord").attr("value")+'" style="width: 100%;" class="bord padd w100" id="ord_input_'+e+'" type="text">',i+="</div>",i+="</td>",i+='<td align="center">',i+='<div id="visible_'+e+'"><b>'+t+"</b></div>",i+='<div id="visible_i_'+e+'" style="display: none;">',i+='<input name="visible_'+e+'" value="1" checked="checked" onclick="$(\'#vis_'+e+"').val('1');\" id=\"visible_input_"+e+'_1" type="radio">Да &nbsp;&nbsp;',i+='<input name="visible_'+e+'" value="0" onclick="$(\'#vis_'+e+"').val('0');\" id=\"visible_input_"+e+'_0" type="radio">Нет',i+='<input name="vis_'+e+'" id="vis_'+e+'" value="" type="hidden">',i+="</div>",i+="</td>",i+="<td>",i+='<a href="#" class="icon icon-edit" onclick="editExtendet(\''+e+"')\"></a>",i+='<a href="#" class="icon icon-delete remove-trigger" onClick="delExtendet(\''+e+"')\"></a>",i+="</td>",i+="</tr>",$(i).insertBefore("#ajax_add_form"),$("#title").attr({value:""}),$("#ord").attr({value:""}),$("#ajax_add_form").hide()}$.post("/"+ADMIN_DIR+"/ajax/vote/",{action:$("#action").attr("value"),id:$("#id").attr("value"),title:$("#title").attr("value"),ord:$("#ord").attr("value"),visible:$("#VoteAddQuestions input:radio[name=visible]:checked").val()},e)}function saveExtendet(e){function t(t){var i;i=1==$("#vis_"+e).val()?"Да":"Нет",$("#title_"+e).html("<b>"+$("#title_input_"+e).attr("value")+"</b>"),$("#ord_"+e).html($("#ord_input_"+e).attr("value")),$("#visible_"+e).html(i),$("#title_"+e).show(),$("#ord_"+e).show(),$("#visible_"+e).show(),$("#title_i_"+e).hide(),$("#ord_i_"+e).hide(),$("#visible_i_"+e).hide()}$.post("/"+ADMIN_DIR+"/ajax/vote/",{action:"update",id:$("#id_"+e).attr("value"),parent_id:$("#parent_id_"+e).attr("value"),title:$("#title_input_"+e).attr("value"),ord:$("#ord_input_"+e).attr("value"),visible:$("#VoteAddQuestions input:radio[name=visible_"+e+"]:checked").val()},t)}function editExtendet(e){$("#title_"+e).hide(),$("#ord_"+e).hide(),$("#visible_"+e).hide(),$("#title_i_"+e).show(),$("#ord_i_"+e).show(),$("#visible_i_"+e).show()}function delExtendet(e){cp.dialog("Вы действительно хотите удалить запись?")&&$.post("/"+ADMIN_DIR+"/ajax/vote/",{action:"del",id:$("#id_"+e).val()},onAjaxSuccessDel)}function onAjaxSuccessDel(e){$("#tr_"+e).remove()}function cancelExtendet(e){$("#title_"+e).show(),$("#ord_"+e).show(),$("#visible_"+e).show(),$("#title_i_"+e).hide(),$("#ord_i_"+e).hide(),$("#visible_i_"+e).hide()}function onAjaxSuccess(e){alert(e)}function editTitle(e,t){if(void 0===t)var t=$("#ftitle_"+e).text();var i=prompt("Введите новое имя",t);return""!=i&&i!=t&&null!==i&&$.ajax({url:"/"+ADMIN_DIR+"/meta/filename",type:"post",data:{id:e,name:i},dataType:"JSON",success:function(t){!0===t.status&&$("#ftitle_"+e).html(i)}}),!1}function editVisible(e,t){return t=1==t?0:1,$.ajax({url:"/"+ADMIN_DIR+"/meta/filevisible",type:"post",data:{id:e,visible:t},dataType:"JSON",success:function(i){!0===i.status&&($("#fvisible_"+e).removeClass("icon-eye icon-eye-off"),1==t?$("#fvisible_"+e).addClass("icon-eye"):$("#fvisible_"+e).addClass("icon-eye-off"))}}),!1}function editOrd(e,t){var i=prompt("Порядок",t);return!!i&&(""!=i&&i!=t&&$.post("/"+ADMIN_DIR+"/ajax/meta/",{action:"newfileord",neword:i,id:e},function(t){1==t&&$("#ordfile_"+e).html(i)}),!1)}function ajax_vis_toggle(e,t,i){return $(e).append('<i class="loading"></i>'),$.post("/"+ADMIN_DIR+"/ajax/structure/",{act:"toggle_visible",mod_id:i,id:t},function(t){1==t&&$(e).toggleClass("icon-eye").toggleClass("icon-eye-off").html("")}),!1}function show_tooltips(e){$("#"+e).toggle()}function my_uncheck(){$(".access").each(function(){$(this).attr({checked:""})})}function CheckAndSubmit(e){var t=!0;if($("#"+e+" .ness").each(function(){if(""==$(this).val())return $(this).focus().addClass("error"),t=!1,!1;$(this).removeClass("error")}),!t)return!1;$("#"+e).submit()}function setSort(e,t){value=$(e).val(),setCookie(t,value),location.href=location.href}function form_submit(e,t){"save"==t&&$("#"+e).submit(),$("#"+e).submit()}function openwin(e,t,i,n){null!=hwnd&&hwnd.close(),hwnd=window.open(e,"","toolbar=no , location=no , directories=no , resizable=no , width="+t+" , height="+i),hwnd.document.open(),hwnd.document.write("<html>"),hwnd.document.write("<head>"),hwnd.document.write("<title>"+n+"</title>"),hwnd.document.write("</head>"),hwnd.document.write("<body bgcolor=#ffffff bottommargin=0 leftmargin=0 marginheight=0 marginwidth=0 rightmargin=0 topmargin=0 style='border:0px;'>"),hwnd.document.write("<table align=center width=100% height=100% cellspacing=0 cellpadding=0 border=0>"),hwnd.document.write("<tr><td><img src='"+e+"' border=0></td></tr>"),hwnd.document.write("</table></body></html>"),hwnd.document.close()}function openwin_text(e,t,i){window.open(e,"","toolbar=no , location=no , directories=no , resizable=no , scrollbars=no , width="+t+" , height="+i)}function ltrim(e){for(var t=0;t<e.length&&isWhitespace(e.charAt(t));t++);return e.substring(t,e.length)}function rtrim(e){for(var t=e.length-1;t>=0&&isWhitespace(e.charAt(t));t--);return e.substring(0,t+1)}function trim(e){return e=e.replace(/\s{2,}/g," "),ltrim(rtrim(e))}function isWhitespace(e){return-1!=" \t\n\r\f".indexOf(e)}function transliterate(e,t){if(""!=(e=trim(e.toLowerCase()))){var i,n,o={},a=[],s="";if(i={"à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","æ":"ae","ç":"c","è":"e","é":"e","ê":"e","ë":"e","ì":"i","í":"i","î":"i","ï":"i","ð":"d","ñ":"n","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ő":"o","ø":"o","ù":"u","ú":"u","û":"u","ü":"u","ű":"u","ý":"y","þ":"th","ÿ":"y","α":"a","β":"b","γ":"g","δ":"d","ε":"e","ζ":"z","η":"h","θ":"8","ι":"i","κ":"k","λ":"l","μ":"m","ν":"n","ξ":"3","ο":"o","π":"p","ρ":"r","σ":"s","τ":"t","υ":"y","φ":"f","χ":"x","ψ":"ps","ω":"w","ά":"a","έ":"e","ί":"i","ό":"o","ύ":"y","ή":"h","ώ":"w","ς":"s","ϊ":"i","ΰ":"y","ϋ":"y","ΐ":"i","ş":"s","ı":"i"},_defineProperty(i,"ç","c"),_defineProperty(i,"ü","u"),_defineProperty(i,"ö","o"),_defineProperty(i,"ğ","g"),_defineProperty(i,"а","a"),_defineProperty(i,"б","b"),_defineProperty(i,"в","v"),_defineProperty(i,"г","g"),_defineProperty(i,"д","d"),_defineProperty(i,"е","e"),_defineProperty(i,"ё","yo"),_defineProperty(i,"ж","zh"),_defineProperty(i,"з","z"),_defineProperty(i,"и","i"),_defineProperty(i,"й","j"),_defineProperty(i,"к","k"),_defineProperty(i,"л","l"),_defineProperty(i,"м","m"),_defineProperty(i,"н","n"),_defineProperty(i,"о","o"),_defineProperty(i,"п","p"),_defineProperty(i,"р","r"),_defineProperty(i,"с","s"),_defineProperty(i,"т","t"),_defineProperty(i,"у","u"),_defineProperty(i,"ф","f"),_defineProperty(i,"х","h"),_defineProperty(i,"ц","c"),_defineProperty(i,"ч","ch"),_defineProperty(i,"ш","sh"),_defineProperty(i,"щ","sch"),_defineProperty(i,"ъ",""),_defineProperty(i,"ы","y"),_defineProperty(i,"ь",""),_defineProperty(i,"э","e"),_defineProperty(i,"ю","yu"),_defineProperty(i,"я","ya"),_defineProperty(i,"є","ye"),_defineProperty(i,"і","i"),_defineProperty(i,"ї","yi"),_defineProperty(i,"ґ","g"),_defineProperty(i,"č","c"),_defineProperty(i,"ď","d"),_defineProperty(i,"ě","e"),_defineProperty(i,"ň","n"),_defineProperty(i,"ř","r"),_defineProperty(i,"š","s"),_defineProperty(i,"ť","t"),_defineProperty(i,"ů","u"),_defineProperty(i,"ž","z"),_defineProperty(i,"ą","a"),_defineProperty(i,"ć","c"),_defineProperty(i,"ę","e"),_defineProperty(i,"ł","l"),_defineProperty(i,"ń","n"),_defineProperty(i,"ó","o"),_defineProperty(i,"ś","s"),_defineProperty(i,"ź","z"),_defineProperty(i,"ż","z"),_defineProperty(i,"ā","a"),_defineProperty(i,"č","c"),_defineProperty(i,"ē","e"),_defineProperty(i,"ģ","g"),_defineProperty(i,"ī","i"),_defineProperty(i,"ķ","k"),_defineProperty(i,"ļ","l"),_defineProperty(i,"ņ","n"),_defineProperty(i,"š","s"),_defineProperty(i,"ū","u"),_defineProperty(i,"ž","z"),o=i,s=e.replace(/[^a-zа-я0-9]/gi,"-"),"cyrillic"==t)s=decodeURIComponent(s);else if("translate"==t)for(n in o)s=s.replace(RegExp(n,"g"),o[n]);else for(n in o)s=s.replace(RegExp(n,"g"),o[n]);"-"==(a=s.split(""))[0]&&(s=s.slice(1)),"-"==a[a.length-1]&&(s=s.slice(0,-1)),e=s}return redouble(e)}function binding(e,t){$("body").on("keyup blur keypress",'input[name="'+e+'"]',function(){if(""!==this.value){var e=$('input[name="'+t+'"]');e.prop("readonly")||e.val(transliterate(this.value,URL_TRANSLATE))}})}function redouble(e){return e=e.replace("__","_"),e=e.replace("_-_","_"),(e=e.replace("--","-")).indexOf("__")>-1?redouble(e):("_"==e.substr(0,1)&&e.length>1&&(e=e.substr(1,e.length)),e)}function ajax_toggle_group(e,t){var i=0;return i=$(e).hasClass("icon-eye-off")?1:0,$(e).append('<i class="loading"></i>'),$.post("/"+ADMIN_DIR+"/ajax/modules/",{action:"devisible",id:t,visible:i},function(t){1==t&&($(e).hasClass("icon-eye-off")?$(e).removeClass("icon-eye-off").addClass("icon-eye").html(""):$(e).removeClass("icon-eye").addClass("icon-eye-off").html(""))}),!1}function toggle_menu(e,t){$(e).toggleClass("minus").toggleClass("plus").parent(),$("#item"+t).toggle()}function toggle_small_photo(e){$("#"+e).toggle()}function hideField(e){title=$("#docs_"+e+" .title_in").val(),ord=$("#docs_"+e+" .ord_in").val(),$("#docs_"+e+" .title_f").empty().append(title),$("#docs_"+e+" .ord_f").empty().append(ord),$("#docs_"+e+" .but_save").hide(),$("#docs_"+e+" .ctr_edit").show()}function EditDocs(e){return $("#docs_"+e+" .but_save").show(),$("#docs_"+e+" .ctr_edit").hide(),curr_value=$("#docs_"+e+" .title_f").text(),$("#docs_"+e+" .title_f").empty().append("<input type='text' value='"+curr_value+"' name='title' class='bord padd w100 title_in' />"),curr_value=$("#docs_"+e+" .ord_f").text(),$("#docs_"+e+" .ord_f").empty().append("<input type='text' value='"+curr_value+"' name='ord' class='bord padd w20 ord_in' />"),$("#docs_"+e+" .title_in").focus(),!1}function SaveDocs(e){return title=$("#docs_"+e+" .title_in").val(),ord=$("#docs_"+e+" .ord_in").val(),title||(alert("Пустое имя документа"),hideField(e)),$.post("/"+ADMIN_DIR+"/ajax/document/",{id:"document_edit",docsid:e,title:title,ord:ord},function(t){alert("Данные обновлены"),hideField(e)}),!1}function DelDocs(e){return cp.dialog("Вы действительно хотите удалить?")&&$.post("/"+ADMIN_DIR+"/ajax/document/",{id:"document_del",docsid:e},function(t){t>0?$("#docs_"+e).hide():alert("ошибка обновления")}),!1}function page_update(item_id){return $.post("/"+ADMIN_DIR+"/ajax/document/",{id:"update",post_id:item_id},function(data){var json=eval("("+data+")");parseMsg(json,"file_docs")}),!1}function parseMsg(e,t){$("#"+t+" .uploadfiles").empty(),$("#"+t+" input:file").attr({value:""}),str='<table style="margin-bottom:10px;width:80%"><tr>\n<td class="h w100">Документ</td>\n<td class="h">Размер</td>\n<td class="h">Удалить</td></tr>\n';var i=0;$.each(e,function(e,n){odd=i%2!=0?"odd ":"",str+='<tr>\n<td class="'+odd+'"><a href="'+n.sys_name+'" title="" target="_blank">'+n.title+"</a></td>\n",str+='<td class="'+odd+'r"> '+n.size+"</td>\n",str+='<td class="actions"><a href="#" onclick="return Module.ajaxFileDelete('+n.id+",'"+t+'\');" class="ctr_a ctr_del margin" title="Удалить" onclick="return confirm(\'Вы действительно хотите удалить?\')"></a></td>\n</tr>\n',i++}),str+="</table>",$("#"+t+" .uploadfiles").append(str)}function ajaxFileDocsUpload(e){}function screening(e){var t=/"/g;return e.replace(t,"&quot;")}function _addslashes(e){return e.replace("/([\"'])/g","\\$1").replace("/\0/g","\\0")}function _stripslashes(e){return e.replace("/\0/g","0").replace("/(.)/g","$1")}function clearCookie(){var e=new Date,t=new Date(e.getTime()-864e5);this.setCookie("co"+this.obj,"cookieValue",t),this.setCookie("cs"+this.obj,"cookieValue",t)}function setCookie(e,t,i,n,o,a){document.cookie=escape(e)+"="+escape(t)+(i?"; expires="+i.toGMTString():"")+(n?"; path="+n:"")+(o?"; domain="+o:"")+(a?"; secure":"")}function getCookie(e){var t="",i=document.cookie.indexOf(escape(e)+"=");if(-1!=i){var n=i+(escape(e)+"=").length,o=document.cookie.indexOf(";",n);t=-1!=o?unescape(document.cookie.substring(n,o)):unescape(document.cookie.substring(n))}return t}function __debug(e,t){var i="";t||(t=0);for(var n="",o=0;o<t+1;o++)n+="    ";if("object"==(void 0===e?"undefined":_typeof(e)))for(var a in e){var s=e[a];"object"==(void 0===s?"undefined":_typeof(s))?(i+=n+"'"+a+"' ...\n",i+=dump(s,t+1)):i+=n+"'"+a+"' => \""+s+'"\n'}else i="===>"+e+"<===("+(void 0===e?"undefined":_typeof(e))+")";return i}function serialize(e){var t,i,n="",o=0,a=function(e){var t,i,n,o,a=void 0===e?"undefined":_typeof(e);if("object"===a&&!e)return"null";if("object"===a){if(!e.constructor)return"object";(t=(n=e.constructor.toString()).match(/(\w+)\(/))&&(n=t[1].toLowerCase()),o=["boolean","number","string","array"];for(i in o)if(n===o[i]){a=o[i];break}}return a},s=a(e);switch(s){case"function":t="";break;case"boolean":t="b:"+(e?"1":"0");break;case"number":t=(Math.round(e)===e?"i":"d")+":"+e;break;case"string":t="s:"+function(e){var t=0,i=0,n=e.length,o="";for(i=0;i<n;i++)t+=(o=e.charCodeAt(i))<128?1:o<2048?2:3;return t}(e)+':"'+e+'"';break;case"array":case"object":t="a";for(i in e)if(e.hasOwnProperty(i)){if("function"===a(e[i]))continue;n+=serialize(i.match(/^[0-9]+$/)?parseInt(i,10):i)+serialize(e[i]),o++}t+=":"+o+":{"+n+"}";break;case"undefined":default:t="N"}return"object"!==s&&"array"!==s&&(t+=";"),t}function unserialize(e){function t(e,i){var n,r,l,d,c,p,u,f,h,m,_,g,v,b,y,w,$,x,C=0,k=function(e){return e};switch(i||(i=0),n=e.slice(i,i+1).toLowerCase(),r=i+2,n){case"i":k=function(e){return parseInt(e,10)},C=(h=a(e,r,";"))[0],f=h[1],r+=C+1;break;case"b":k=function(e){return 0!==parseInt(e,10)},C=(h=a(e,r,";"))[0],f=h[1],r+=C+1;break;case"d":k=function(e){return parseFloat(e)},C=(h=a(e,r,";"))[0],f=h[1],r+=C+1;break;case"n":f=null;break;case"s":C=(m=a(e,r,":"))[0],_=m[1],C=(h=s(e,(r+=C+2)+1,parseInt(_,10)))[0],f=h[1],r+=C+2,C!==parseInt(_,10)&&C!==f.length&&o("SyntaxError","String length mismatch");break;case"a":for(f={},C=(l=a(e,r,":"))[0],d=l[1],r+=C+2,p=parseInt(d,10),c=!0,g=0;g<p;g++)y=(b=t(e,r))[1],v=b[2],$=(w=t(e,r+=y))[1],x=w[2],r+=$,v!==g&&(c=!1),f[v]=x;if(c){for(u=new Array(p),g=0;g<p;g++)u[g]=f[g];f=u}r+=1;break;default:o("SyntaxError","Unknown / Unhandled data type(s): "+n)}return[n,r-i,k(f)]}var i="undefined"!=typeof window?window:global,n=function(e){for(var t=e.length,i=e.length-1;i>=0;i--){var n=e.charCodeAt(i);n>127&&n<=2047?t++:n>2047&&n<=65535&&(t+=2),n>=56320&&n<=57343&&i--}return t-1},o=function(e,t,n,o){throw new i[e](t,n,o)},a=function(e,t,i){for(var n=2,a=[],s=e.slice(t,t+1);s!==i;)n+t>e.length&&o("Error","Invalid"),a.push(s),s=e.slice(t+(n-1),t+n),n+=1;return[a.length,a.join("")]},s=function(e,t,i){var o,a,s;for(s=[],o=0;o<i;o++)a=e.slice(t+(o-1),t+o),s.push(a),i-=n(a);return[s.length,s.join("")]};return t(e+"",0)[2]}var getSettings={merge:function(e,t){return Object.assign({},e,t)},codemirror:function(e){return this.merge(e,{gutters:["note-gutter","CodeMirror-linenumbers"],tabSize:4,indentUnit:4,lineNumbers:!0,lineWrapping:!0,tabMode:"indent",autofocus:!1,smartIndent:!1,enterMode:"keep",smartyVersion:3,continueComments:"Enter"})},tinymce:function(e){return this.merge(e,{theme:"modern",skin:"lightgray",menubar:!0,fullpage:!1,image_advtab:!0,visualblocks_default_state:!1,end_container_on_empty_block:!0,plugins:["advlist autolink autosave link image lists charmap print preview hr anchor pagebreak spellchecker","searchreplace wordcount visualblocks visualchars code fullscreen insertdatetime media nonbreaking","table contextmenu directionality emoticons template textcolor paste fullpage colorpicker textpattern"],toolbar:"code | formatselect fontselect fontsizeselect | bold italic underline strikethrough | alignleft aligncenter alignright alignjustify | bullist numlist | outdent indent blockquote | link unlink anchor | image media | hr removeformat | forecolor backcolor",toolbar_items_size:"small",style_formats:[{title:"h1",inline:"h1",classes:"h1"},{title:"h2",inline:"h2",classes:"h2"},{title:"h3",inline:"h3",classes:"h3"},{title:"h4",inline:"h4",classes:"h4"},{title:"h5",inline:"h5",classes:"h5"},{title:"h6",inline:"h6",classes:"h6"},{title:"Paragraph",inline:"p"},{title:"Red text",inline:"span",styles:{color:"#f00"}}],content_css:[]})},imperavi:function(e){return this.merge(e,{lang:"ru",minHeight:10,maxHeight:850,buttonSource:!0,placeholder:"Содержимое блока...",tabAsSpaces:4,codemirror:!0,formatting:["p","div","blockquote","pre","h1","h2","h3","h4","h5","h6"],fixed:!0,visual:!0,toolbarFixed:!0,toolbarOverflow:!0,fullpage:!1,autoresize:!0,linebreaks:!1,cleanSpaces:!0,cleanOnPaste:!0,pastePlainText:!1,convertDivs:!1,removeComments:!0,cleanStyleOnEnter:!1,removeDataAttr:!1,observeLinks:!0,autoformat:!1,removeClasses:!1,removeStyles:!1,convertLinks:!0,convertUrlLinks:!0,removeEmptyTags:!0,convertImageLinks:!0,convertVideoLinks:!0,imageFloatMargin:"15px",buttonsHideOnMobile:["image","video"],replaceStyles:[["font-weight:s?bold","strong"],["font-weight:s?700","strong"],["font-style:s?italic","em"],["text-decoration:s?underline","u"]],removeEmpty:["strong","em","span","p","div","i","b"],plugins:["table","video","filemanager","limiter","fontcolor","fontsize","fontfamily","textdirection","imagemanager","definedlinks","counter","clips","fullscreen"],formattingAdd:[{tag:"h6",title:"Заголовок 6"}],replaceTags:[["strike","del"],["i","em"],["b","strong"],["big","strong"],["strike","del"]],deniedTags:["html","head","link","body","meta","applet","style","script","meta","link"],buttonsAdd:["pre","|"],activeButtonsAdd:{pre:"pre"},buttonsCustom:{pre:{title:"Code",callback:function(){this.formatBlocks("pre")}}},fileManagerJson:"/tests/files.json",fileUpload:"/apps/upload/file_upload.php",imageUpload:"/apps/upload/image_upload.php",clipboardUploadUrl:"/apps/upload/clipboard.php"})}};!function(e){e.browser={},e.browser.mozilla=/mozilla/.test(navigator.userAgent.toLowerCase())&&!/webkit/.test(navigator.userAgent.toLowerCase()),e.browser.webkit=/webkit/.test(navigator.userAgent.toLowerCase()),e.browser.opera=/opera/.test(navigator.userAgent.toLowerCase()),e.browser.msie=/msie/.test(navigator.userAgent.toLowerCase())}(jQuery);var _editor={codemirror:function(e,t){var i=document.getElementById(e);"xml"==t&&(t={name:"xml",alignCDATA:!0}),"sql"==t&&(t="text/x-mariadb",window.location.href.indexOf("mime=")>-1&&(t=window.location.href.substr(window.location.href.indexOf("mime=")+5))),CodeMirror.fromTextArea(i,getSettings.codemirror({mode:t,extraKeys:{"Ctrl-S":function(e){return saving(),!1},"Cmd-S":function(e){return saving(),!1},"Ctrl-Q":"toggleComment","Cmd-Q":"toggleComment"}}))},init:function(e,t,i){void 0!==this[t]&&this[t](e,i)}},d=document,css=function(e,t){for(var i in t)e.style[i]=t[i]},animate=function(e,t){var i=new Date,n=setInterval(function(){var o=(new Date-i)/e.duration;o>1&&(o=1),e.step(o),1==o&&(t&&t.apply(),clearInterval(n))},e.delay||20);return{stop:function(){clearInterval(n)}}},addClass=function(e,t){var i=e.className;-1==i.indexOf(t)&&(""!=i&&(t=" "+t),e.className=i+t)},removeClass=function(e,t){var i=e.className,n=new RegExp("\\s?\\b"+t+"\\b","g");i=i.replace(n,""),e.className=i},mapConteiner=function(e,t){"google"===e?googleMaps(t):"yandex"===e&&yandexMaps(t)},datepicker=function(){var e=this;$(".calendar").each(function(t,i){var n=$(i).closest(".calendar"),o=n.find(".calendar-input"),a=o.is(":disabled"),s=o.data("timestamp")||!1,r=!1!==s?"DD.MM.YYYY":o.data("format")||"DD.MM.YYYY";if(r=r.toLowerCase(),!a){o.prop("date",""),o.data("format",r);var l=o.datepicker({format:r,autoclose:!0,container:n,language:ADMIN_LOCALE});l.on("changeDate",function(t){var i=$(e).data("date");!1!==s&&(i=new Date(i).getTime()/1e3),o.val(l.datepicker("getFormattedDate"))}),n.find(".input-group-addon")&&n.find(".input-group-addon").on("click",function(){l.datepicker("show")})}})};!function(e,t,i,n){function o(t,n){this.w=e(i),this.el=e(t),this.options=e.extend({},r,n),this.init()}var a="ontouchstart"in i,s=function(){var e=i.createElement("div"),n=i.documentElement;if(!("pointerEvents"in e.style))return!1;e.style.pointerEvents="auto",e.style.pointerEvents="x",n.appendChild(e);var o=t.getComputedStyle&&"auto"===t.getComputedStyle(e,"").pointerEvents;return n.removeChild(e),!!o}(),r={listNodeName:"ol",itemNodeName:"li",rootClass:"dd",listClass:"dd-list",itemClass:"dd-item",dragClass:"dd-dragel",handleClass:"dd-handle",collapsedClass:"dd-collapsed",placeClass:"dd-placeholder",noDragClass:"dd-nodrag",emptyClass:"dd-empty",expandBtnHTML:'<button data-action="expand" type="button" class="dd-button dd-button__expand"></button>',collapseBtnHTML:'<button data-action="collapse" type="button" class="dd-button dd-button__collapse"></button>',group:0,maxDepth:5,threshold:20,dragStop:null,afterExpand:null,afterCollapse:null};o.prototype={init:function(){var i=this;i.reset(),i.el.data("nestable-group",this.options.group),i.placeEl=e('<div class="'+i.options.placeClass+'"/>'),e.each(this.el.find(i.options.itemNodeName),function(t,n){i.setParent(e(n))}),i.el.on("click","button",function(t){if(!i.dragEl){var n=e(t.currentTarget),o=n.data("action"),a=n.parent(i.options.itemNodeName);"collapse"===o&&i.collapseItem(a),"expand"===o&&i.expandItem(a)}});var n=function(t){var n=e(t.target);if(!n.hasClass(i.options.handleClass)){if(n.closest("."+i.options.noDragClass).length)return;n=n.closest("."+i.options.handleClass)}n.length&&!i.dragEl&&(i.isTouch=/^touch/.test(t.type),i.isTouch&&1!==t.touches.length||(t.preventDefault(),i.dragStart(t.touches?t.touches[0]:t)))},o=function(e){i.dragEl&&(e.preventDefault(),i.dragMove(e.touches?e.touches[0]:e))},s=function(e){i.dragEl&&(e.preventDefault(),i.dragStop(e.touches?e.touches[0]:e))};a&&(i.el[0].addEventListener("touchstart",n,!1),t.addEventListener("touchmove",o,!1),t.addEventListener("touchend",s,!1),t.addEventListener("touchcancel",s,!1)),i.el.on("mousedown",n),i.w.on("mousemove",o),i.w.on("mouseup",s)},serialize:function(){var t=this;return step=function(e){function t(t,i){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(i,n){var o=[];return i.children(t.options.itemNodeName).each(function(){var i=e(this),a=e.extend({},i.data()),s=i.children(t.options.listNodeName);s.length&&(a.children=step(s,n+1)),o.push(a)}),o}),step(t.el.find(t.options.listNodeName).first(),0)},serialise:function(){return this.serialize()},reset:function(){this.mouse={offsetX:0,offsetY:0,startX:0,startY:0,lastX:0,lastY:0,nowX:0,nowY:0,distX:0,distY:0,dirAx:0,dirX:0,dirY:0,lastDirX:0,lastDirY:0,distAxX:0,distAxY:0},this.isTouch=!1,this.moving=!1,this.dragEl=null,this.dragRootEl=null,this.dragDepth=0,this.hasNewRoot=!1,this.pointEl=null},expandItem:function(e){e.removeClass(this.options.collapsedClass),e.children('[data-action="expand"]').hide(),e.children('[data-action="collapse"]').show(),e.children(this.options.listNodeName).show(),"function"==typeof this.options.afterExpand&&this.options.afterExpand(e)},collapseItem:function(e){e.children(this.options.listNodeName).length&&(e.addClass(this.options.collapsedClass),e.children('[data-action="collapse"]').hide(),e.children('[data-action="expand"]').show(),e.children(this.options.listNodeName).hide()),"function"==typeof this.options.afterCollapse&&this.options.afterCollapse(e)},expandAll:function(){var t=this;t.el.find(t.options.itemNodeName).each(function(){t.expandItem(e(this))})},collapseAll:function(){var t=this;t.el.find(t.options.itemNodeName).each(function(){t.collapseItem(e(this))})},setParent:function(t){t.children(this.options.listNodeName).length&&(t.find(".dd-button__expand").length||t.prepend(e(this.options.expandBtnHTML)),t.find(".dd-button__collapse").length||t.prepend(e(this.options.collapseBtnHTML))),e(t[0]).hasClass("dd-collapsed")?t.children('[data-action="collapse"]').hide():t.children('[data-action="expand"]').hide()},unsetParent:function(e){e.removeClass(this.options.collapsedClass),e.children("[data-action]").remove(),e.children(this.options.listNodeName).remove()},dragStart:function(t){var n=this.mouse,o=e(t.target),a=o.closest(this.options.itemNodeName);this.placeEl.css("height",a.height()),n.offsetX=void 0!==t.offsetX?t.offsetX:t.pageX-o.offset().left,n.offsetY=void 0!==t.offsetY?t.offsetY:t.pageY-o.offset().top,n.startX=n.lastX=t.pageX,n.startY=n.lastY=t.pageY,this.dragRootEl=this.el,this.dragEl=e(i.createElement(this.options.listNodeName)).addClass(this.options.listClass+" "+this.options.dragClass),this.dragEl.css("width",a.width()),a.after(this.placeEl),a[0].parentNode.removeChild(a[0]),a.appendTo(this.dragEl),e(i.body).append(this.dragEl),this.dragEl.css({left:t.pageX-n.offsetX,top:t.pageY-n.offsetY});var s,r,l=this.dragEl.find(this.options.itemNodeName);for(s=0;s<l.length;s++)(r=e(l[s]).parents(this.options.listNodeName).length)>this.dragDepth&&(this.dragDepth=r)},dragStop:function(e){var t=this.dragEl.children(this.options.itemNodeName).first();t[0].parentNode.removeChild(t[0]),this.placeEl.replaceWith(t),this.dragEl.remove(),this.el.trigger("change"),this.hasNewRoot&&this.dragRootEl.trigger("change"),this.reset(),"function"==typeof this.options.dragStop&&this.options.dragStop(t)},dragMove:function(n){var o,a,r,l=this.options,d=this.mouse;this.dragEl.css({left:n.pageX-d.offsetX,top:n.pageY-d.offsetY}),d.lastX=d.nowX,d.lastY=d.nowY,d.nowX=n.pageX,d.nowY=n.pageY,d.distX=d.nowX-d.lastX,d.distY=d.nowY-d.lastY,d.lastDirX=d.dirX,d.lastDirY=d.dirY,d.dirX=0===d.distX?0:d.distX>0?1:-1,d.dirY=0===d.distY?0:d.distY>0?1:-1;var c=Math.abs(d.distX)>Math.abs(d.distY)?1:0;if(!d.moving)return d.dirAx=c,void(d.moving=!0);d.dirAx!==c?(d.distAxX=0,d.distAxY=0):(d.distAxX+=Math.abs(d.distX),0!==d.dirX&&d.dirX!==d.lastDirX&&(d.distAxX=0),d.distAxY+=Math.abs(d.distY),0!==d.dirY&&d.dirY!==d.lastDirY&&(d.distAxY=0)),d.dirAx=c,d.dirAx&&d.distAxX>=l.threshold&&(d.distAxX=0,r=this.placeEl.prev(l.itemNodeName),d.distX>0&&r.length&&!r.hasClass(l.collapsedClass)&&(o=r.find(l.listNodeName).last(),this.placeEl.parents(l.listNodeName).length+this.dragDepth<=l.maxDepth&&(o.length?(o=r.children(l.listNodeName).last()).append(this.placeEl):((o=e("<"+l.listNodeName+"/>").addClass(l.listClass)).append(this.placeEl),r.append(o),this.setParent(r)))),d.distX<0&&(this.placeEl.next(l.itemNodeName).length||(a=this.placeEl.parent(),this.placeEl.closest(l.itemNodeName).after(this.placeEl),a.children().length||this.unsetParent(a.parent()))));var p=!1;if(s||(this.dragEl[0].style.visibility="hidden"),this.pointEl=e(i.elementFromPoint(n.pageX-i.body.scrollLeft,n.pageY-(t.pageYOffset||i.documentElement.scrollTop))),s||(this.dragEl[0].style.visibility="visible"),this.pointEl.hasClass(l.handleClass)&&(this.pointEl=this.pointEl.parent(l.itemNodeName)),this.pointEl.hasClass(l.emptyClass))p=!0;else if(!this.pointEl.length||!this.pointEl.hasClass(l.itemClass))return;var u=this.pointEl.closest("."+l.rootClass),f=this.dragRootEl.data("nestable-id")!==u.data("nestable-id");if(!d.dirAx||f||p){if(f&&l.group!==u.data("nestable-group"))return;if(this.dragDepth-1+this.pointEl.parents(l.listNodeName).length>l.maxDepth)return;var h=n.pageY<this.pointEl.offset().top+this.pointEl.height()/2;a=this.placeEl.parent(),p?((o=e(i.createElement(l.listNodeName)).addClass(l.listClass)).append(this.placeEl),this.pointEl.replaceWith(o)):h?this.pointEl.before(this.placeEl):this.pointEl.after(this.placeEl),a.children().length||this.unsetParent(a.parent()),this.dragRootEl.find(l.itemNodeName).length||this.dragRootEl.append('<div class="'+l.emptyClass+'"/>'),f&&(this.dragRootEl=u,this.hasNewRoot=this.el[0]!==this.dragRootEl[0])}}},e.fn.nestable=function(t){var i=this,n=this;return i.each(function(){var i=e(this).data("nestable");i?"string"==typeof t&&"function"==typeof i[t]&&(n=i[t]()):(e(this).data("nestable",new o(this,t)),e(this).data("nestable-id",(new Date).getTime()))}),n||i}}(window.jQuery||window.Zepto,window,document),Array.prototype.max=function(){return Math.max.apply(null,this)},Array.prototype.min=function(){return Math.min.apply(null,this)};var _redactor={imperavi:function(e){var t=$(["#",e].join(""))[0];$(t).redactor(getSettings.imperavi({mode:"htmlmixed"})),CodeMirror.fromTextArea(t,getSettings.codemirror({mode:"htmlmixed"}))},tinymce:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){tinymce.init(getSettings.tinymce({selector:["#",e].join("")}))}),cleditor:function(e){$(["#",e].join("")).cleditor()},froala:function(e){$(["#",e].join("")).froalaEditor({language:"ru",toolbarButtons:["fullscreen","bold","italic","underline","strikeThrough","subscript","superscript","|","fontFamily","fontSize","color","inlineStyle","paragraphStyle","|","paragraphFormat","align","formatOL","formatUL","outdent","indent","quote","-","insertLink","insertImage","insertVideo","insertFile","insertTable","|","emoticons","specialCharacters","insertHR","selectAll","clearFormatting","|","print","spellChecker","help","html","|","undo","redo"],pluginsEnabled:null})},summernote:function(e){$(["#",e].join("")).summernote({height:200,tabsize:2,toolbar:!0,codemirror:{theme:"monokai"}})},ckeditor:function(e){CKEDITOR.config.width="auto",CKEDITOR.config.height=600,CKEDITOR.disableAutoInline=!0,CKEDITOR.replace(e,{customConfig:"/apps/wysiwyg/ckeditor/config.js"})},wysiwyg:function(e){$(["#",e].join("")).wysiwyg({toolbar:"top",hotKeys:{"ctrl+b meta+b":"bold","ctrl+i meta+i":"italic","ctrl+u meta+u":"underline","ctrl+z meta+z":"undo","ctrl+y meta+y meta+shift+z":"redo"}})},init:function(e,t){void 0!==this[t]&&this[t](e)}};!function(e){e.fn.timeoutClass=function(t,i){i=i||10;var n=this;setTimeout(function(){e(n).toggleClass(t)},i)}}(jQuery);var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};